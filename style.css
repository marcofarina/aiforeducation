/* Tailwind utility-first per la maggior parte degli stili.
   Questo file contiene solo piccole rifiniture condivise. */

:root{
  --ring: 0 0% 0%;
}

html { scroll-behavior: smooth; }

/* Cards */
.card{
  @apply rounded-2xl border border-zinc-200 bg-white shadow-sm transition hover:shadow-md;
}
.card-body{ @apply p-5; }

/* Buttons */
.btn-primary{
  @apply inline-flex items-center justify-center rounded-xl px-3.5 py-2 text-sm font-medium border border-emerald-600 bg-emerald-600 text-white hover:bg-emerald-700 focus:outline-none focus:ring-2 focus:ring-emerald-600/40;
}
.btn-disabled{
  @apply inline-flex items-center justify-center rounded-xl px-3.5 py-2 text-sm font-medium border border-zinc-300 text-zinc-500;
}

/* TOC links */
.toc-link, .toc-sublink{ @apply block px-2 py-1 rounded-md text-zinc-700 hover:bg-zinc-100; }
.toc-link.active, .toc-sublink.active{ @apply bg-emerald-50 text-emerald-700 font-medium; }

/* Pager */
.pager{ @apply inline-flex items-center rounded-xl px-3.5 py-2 text-sm border border-zinc-300 hover:bg-zinc-50; }
.pager.disabled{ @apply text-zinc-400 bg-zinc-50 border-zinc-200 pointer-events-none; }

/* Mobile TOC visibility */
#toc[hidden]{ display: none; }

/* Basic typography improvements beyond prose */
.prose :where(h1,h2,h3){ scroll-margin-top: 6rem; }

/* Scrollbar subtle styling (supported browsers) */
*::-webkit-scrollbar{ width: 10px; height: 10px; }
*::-webkit-scrollbar-thumb{ background: #e5e7eb; border-radius: 9999px; }
*::-webkit-scrollbar-thumb:hover{ background: #d4d4d8; }


/* =============================
FILE: app.js
============================== */
// Year in footer
(function(){
  const y = new Date().getFullYear();
  document.querySelectorAll('#year').forEach(el => el.textContent = y);
})();

// Mobile TOC toggle
(function(){
  const btn = document.getElementById('tocToggle');
  const toc = document.getElementById('toc');
  if(!btn || !toc) return;
  // Start hidden on mobile
  if (window.matchMedia('(max-width: 767px)').matches) toc.setAttribute('hidden','');
  btn.addEventListener('click', ()=>{
    if (toc.hasAttribute('hidden')) toc.removeAttribute('hidden');
    else toc.setAttribute('hidden','');
  });
})();

// TOC active section highlighter
(function(){
  const links = Array.from(document.querySelectorAll('.toc-link, .toc-sublink'));
  if(!links.length) return;
  const map = new Map();
  links.forEach(a => {
    const id = a.getAttribute('href')?.slice(1);
    const target = id ? document.getElementById(id) : null;
    if(target) map.set(target, a);
  });

  const observer = new IntersectionObserver((entries)=>{
    entries.forEach(entry => {
      const link = map.get(entry.target);
      if(!link) return;
      if(entry.isIntersecting){
        links.forEach(l => l.classList.remove('active'));
        link.classList.add('active');
      }
    });
  }, { rootMargin: '0px 0px -70% 0px', threshold: 0.01 });

  map.forEach((_, section)=> observer.observe(section));
})();
